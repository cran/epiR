<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mark Stevenson" />

<meta name="date" content="2023-08-15" />

<title>Sample Size Calculations Using epiR</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 800px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 20px;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 0;
padding: 4px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table:not([class]) {
margin: auto;
min-width: 40%;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table[summary="R argblock"] {
width: 100%;
border: none;
}
table:not([class]) th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table:not([class]) td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table:not([class]), table:not([class]) th, table:not([class]) td {
border-left-style: none;
border-right-style: none;
}
table:not([class]) tr.odd {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 13px;
padding-bottom: 1px;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f5f5f5;
border-radius: 3px;
color: #333;
}
pre {
overflow-x: auto;
border-radius: 3px;
margin: 5px 0 10px 0;
padding: 10px;
}
pre:not([class]) {
background-color: white;
border: #f5f5f5 1px solid;
}
pre:not([class]) code {
color: #444;
background-color: white;
}
code {
font-family: monospace;
font-size: 90%;
}
p > code, li > code {
padding: 2px 4px;
color: #d14;
border: 1px solid #e1e1e8;
white-space: inherit;
}
div.figure {
text-align: center;
}
table > caption, div.figure p.caption {
font-style: italic;
}
table > caption span, div.figure p.caption span {
font-style: normal;
font-weight: bold;
}
p {
margin: 0 0 10px;
}
table:not([class]) {
margin: auto auto 10px auto;
}
img:not([class]) {
background-color: #FFFFFF;
padding: 2px;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
max-width: 100%;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f5f5f5;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f5f5f5;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f5f5f5;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }
div.r-help-page {
background-color: #f9f9f9;
border-bottom: #ddd 1px solid;
margin-bottom: 10px;
padding: 10px;
}
div.r-help-page:hover {
background-color: #f4f4f4;
}

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Sample Size Calculations Using epiR</h1>
<h4 class="author">Mark Stevenson</h4>
<h4 class="date">2023-08-15</h4>



<p>The EpiTools app for <a href="https://apps.apple.com/vn/app/epi-tools/id1611139482">iPhone</a>
and <a href="https://play.google.com/store/apps/details?id=au.melbourne.uni.epitools">Android</a>
devices provides access to many of the sample size functions in
<code>epiR</code> using a smart phone.</p>
<div id="prevalence-estimation" class="section level3">
<h3>Prevalence estimation</h3>
<p>A review of sample size calculations in (veterinary) epidemiological
research is provided by <span class="citation">Stevenson (<a href="#ref-stevenson:2021" role="doc-biblioref">2021</a>)</span>.</p>
<p>The expected seroprevalence of brucellosis in a population of cattle
is thought to be in the order of 15%. How many cattle need to be sampled
and tested to be 95% certain that our seroprevalence estimate is within
20% of the true population value. That is, from 15 - (0.20 <span class="math inline">\(\times\)</span> 0.15) to 15 + (0.20 <span class="math inline">\(\times\)</span> 0.15 = 0.03) i.e., from 12% to
18%. Assume the test you will use has perfect sensitivity and
specificity. The population size is unknown so we set
<code>N = NA</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sssimpleestb</span>(<span class="at">N =</span> <span class="cn">NA</span>, <span class="at">Py =</span> <span class="fl">0.15</span>, <span class="at">epsilon =</span> <span class="fl">0.20</span>, <span class="at">error =</span> <span class="st">&quot;relative&quot;</span>, <span class="at">se =</span> <span class="dv">1</span>, <span class="at">sp =</span> <span class="dv">1</span>, <span class="at">nfractional =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 545</span></span></code></pre></div>
<p>A total of 545 cows need to be sampled to meet the requirements of
the study. Let’s say we have a reasonable estimate of the size of the
cattle population at risk, 4000. Re-run <code>epi.sssimpleestb</code>,
specifying <code>N</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sssimpleestb</span>(<span class="at">N =</span> <span class="dv">4000</span>, <span class="at">Py =</span> <span class="fl">0.15</span>, <span class="at">epsilon =</span> <span class="fl">0.20</span>, <span class="at">error =</span> <span class="st">&quot;relative&quot;</span>, <span class="at">se =</span> <span class="dv">1</span>, <span class="at">sp =</span> <span class="dv">1</span>, <span class="at">nfractional =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 480</span></span></code></pre></div>
<p>If the size of the population at risk is 4000, 480 cows need to be
sampled to meet the requirements of the study. When a value for
<code>N</code> is provided in <code>epi.sssimpleestb</code> the function
automatically applies a finite correction factor. In this example if we
assumed an infinite (i.e., very large) population size the required
sample size was 545. When the population size was (only) 4000, the
required sample size reduced to 480.</p>
</div>
<div id="prospective-cohort-study" class="section level3">
<h3>Prospective cohort study</h3>
<p>A prospective cohort study of dry food diets and feline lower urinary
tract disease (FLUTD) in mature male cats is planned. A sample of cats
will be selected at random from the population of cats in a given area
and owners who agree to participate in the study will be asked to
complete a questionnaire at the time of enrollment. Cats enrolled into
the study will be followed for at least 5 years to identify incident
cases of FLUTD. The investigators would like to be 0.80 certain of being
able to detect when the risk ratio of FLUTD is 1.4 for cats habitually
fed a dry food diet, using a 0.05 significance test. Previous evidence
suggests that the incidence risk of FLUTD in cats not on a dry food
(i.e., ‘other’) diet is around 50 per 1000. Assuming equal numbers of
cats on dry food and other diets are sampled, how many cats should be
sampled to meet the requirements of the study?</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscohortt</span>(<span class="at">irexp1 =</span> <span class="dv">70</span><span class="sc">/</span><span class="dv">1000</span>, <span class="at">irexp0 =</span> <span class="dv">50</span><span class="sc">/</span><span class="dv">1000</span>, <span class="at">FT =</span> <span class="dv">5</span>, <span class="at">n =</span> <span class="cn">NA</span>, <span class="at">power =</span> <span class="fl">0.80</span>, <span class="at">r =</span> <span class="dv">1</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">design =</span> <span class="dv">1</span>, <span class="at">sided.test =</span> <span class="dv">2</span>, <span class="at">nfractional =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>n.total</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2080</span></span></code></pre></div>
<p>A total of 2080 subjects are required (1040 exposed and 1040
unexposed).</p>
<p>It’s important to remember that you can use the
<code>epi.sscohortt</code> (and other sample size functions in
<code>epiR</code>) to return the study power if a value for
<code>n</code> is provided. Continuing the example above, imagine that
only 1500 cats were enrolled into the study. What is the expected study
power? Here we set <code>n = 1500</code> and <code>power = NA</code> in
<code>epi.sscohortt</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscohortt</span>(<span class="at">irexp1 =</span> <span class="dv">70</span><span class="sc">/</span><span class="dv">1000</span>, <span class="at">irexp0 =</span> <span class="dv">50</span><span class="sc">/</span><span class="dv">1000</span>, <span class="at">FT =</span> <span class="dv">5</span>, <span class="at">n =</span> <span class="dv">1500</span>, <span class="at">power =</span> <span class="cn">NA</span>, <span class="at">r =</span> <span class="dv">1</span>, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">design =</span> <span class="dv">1</span>, <span class="at">sided.test =</span> <span class="dv">2</span>, <span class="at">nfractional =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>power</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.6629312</span></span></code></pre></div>
<p>If only 1500 cats are enrolled into the study the expected study
power is 0.66.</p>
</div>
<div id="case-control-study" class="section level3">
<h3>Case-control study</h3>
<p>A case-control study of the relationship between white pigmentation
around the eyes and ocular squamous cell carcinoma in Hereford cattle is
planned. A sample of cattle with newly diagnosed squamous cell carcinoma
will be compared for white pigmentation around the eyes with a sample of
controls. Assuming an equal number of cases and controls, how many study
subjects are required to detect an odds ratio of 2.0 with 0.80 power
using a two-sided 0.05 test? Previous surveys have shown that around
0.30 of Hereford cattle without squamous cell carcinoma have white
pigmentation around the eyes.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscc</span>(<span class="at">OR =</span> <span class="fl">2.0</span>, <span class="at">p1 =</span> <span class="cn">NA</span>, <span class="at">p0 =</span> <span class="fl">0.30</span>, <span class="at">n =</span> <span class="cn">NA</span>, <span class="at">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">r =</span> <span class="dv">1</span>, <span class="at">phi.coef =</span> <span class="dv">0</span>, <span class="at">design =</span> <span class="dv">1</span>, <span class="at">sided.test =</span> <span class="dv">2</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">method =</span> <span class="st">&quot;unmatched&quot;</span>, <span class="at">nfractional =</span> <span class="cn">FALSE</span>, <span class="at">fleiss =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n.total</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 282</span></span></code></pre></div>
<p>If the true odds for squamous cell carcinoma in exposed subjects
relative to unexposed subjects is 2.0, we will need to enroll 141 cases
and 141 controls (282 cattle in total) to reject the null hypothesis
that the odds ratio equals one with probability (power) 0.80. The Type I
error probability associated with the test of this null hypothesis is
0.05.</p>
</div>
<div id="non-inferiority-trial" class="section level3">
<h3>Non-inferiority trial</h3>
<p>Suppose a pharmaceutical company would like to conduct a clinical
trial to compare the efficacy of two antimicrobial agents when
administered orally to patients with skin infections. Assume the true
mean cure rate of the treatment is 0.85 and the true mean cure rate of
the control is 0.65. We consider a difference of less than 0.10 in cure
rate to be of no clinical importance (i.e., delta = 0.10). Assuming a
one-sided test size of 5% and a power of 80%, how many subjects should
be included in the trial?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.ssninfb</span>(<span class="at">treat =</span> <span class="fl">0.85</span>, <span class="at">control =</span> <span class="fl">0.65</span>, <span class="at">delta =</span> <span class="fl">0.10</span>, <span class="at">n =</span> <span class="cn">NA</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">r =</span> <span class="dv">1</span>, <span class="at">power =</span> <span class="fl">0.80</span>, <span class="at">nfractional =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)<span class="sc">$</span>n.total</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 50</span></span></code></pre></div>
<p>A total of 50 subjects need to be enrolled in the trial, 25 in the
treatment group and 25 in the control group.</p>
</div>
<div id="one-stage-cluster-sampling" class="section level3">
<h3>One-stage cluster sampling</h3>
<p>An aid project has distributed cook stoves in a single province in a
resource-poor country. At the end of three years, the donors would like
to know what proportion of households are still using their donated
stove. A cross-sectional study is planned where villages in a province
will be sampled and then all households (approximately 75 per village)
will be visited to determine if their donated stove is still in use. A
pilot study of the prevalence of stove usage in five villages showed
that 0.46 of householders were still using their stove and the
intracluster correlation coefficient (ICC) for stove use within villages
is in the order of 0.20. If the donor wanted to be 95% confident that
the survey estimate of stove usage was within 10% of the true population
value, how many villages (primary sampling units) need to be
sampled?</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.ssclus1estb</span>(<span class="at">b =</span> <span class="dv">75</span>, <span class="at">Py =</span> <span class="fl">0.46</span>, <span class="at">epsilon =</span> <span class="fl">0.10</span>, <span class="at">error =</span> <span class="st">&quot;relative&quot;</span>, <span class="at">rho =</span> <span class="fl">0.20</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>n.psu</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 96</span></span></code></pre></div>
<p>A total of 96 villages need to be sampled to meet the requirements of
the study.</p>
</div>
<div id="one-stage-cluster-sampling-continued" class="section level3">
<h3>One-stage cluster sampling (continued)</h3>
<p>Continuing the example above, we are now told that the number of
households per village varies. The average number of households per
village is 75 with a 0.025 quartile of 40 households and a 0.975
quartile of 180. Assuming the number of households per village follows a
normal distribution the expected standard deviation of the number of
households per village is in the order of (180 - 40) <span class="math inline">\(\div\)</span> 4 = 35. How many villages (primary
sampling units) need to be sampled?</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.ssclus1estb</span>(<span class="at">b =</span> <span class="fu">c</span>(<span class="dv">75</span>,<span class="dv">35</span>), <span class="at">Py =</span> <span class="fl">0.46</span>, <span class="at">epsilon =</span> <span class="fl">0.10</span>, <span class="at">error =</span> <span class="st">&quot;relative&quot;</span>, <span class="at">rho =</span> <span class="fl">0.20</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>n.psu</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 115</span></span></code></pre></div>
<p>A total of 115 villages need to be sampled to meet the requirements
of the study.</p>
</div>
<div id="two-stage-cluster-sampling" class="section level3">
<h3>Two-stage cluster sampling</h3>
<p>This example is adapted from <span class="citation">Bennett et al.
(<a href="#ref-bennett_et_al:1991" role="doc-biblioref">1991</a>)</span>. We intend to conduct a
cross-sectional study to determine the prevalence of disease X in a
given country. This is a hierarchical data set with individuals
(secondary sampling units) clustered within villages (primary sampling
units). The expected prevalence of disease is thought to be around 20%.
Previous studies report an intracluster correlation coefficient for this
disease to be 0.02. Suppose that we want to be 95% certain that our
estimate of the prevalence of disease is within 5% of the true
population value and that we’ll sample 20 individuals per village. How
many villages should be sampled to meet the requirements of the study?
Assume that you don’t know the total number of villages in the country,
so set <code>N = NA</code> in <code>epi.simpleestb</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># From first principles:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>n.crude <span class="ot">&lt;-</span> <span class="fu">epi.sssimpleestb</span>(<span class="at">N =</span> <span class="cn">NA</span>, <span class="at">Py =</span> <span class="fl">0.20</span>, <span class="at">epsilon =</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="fl">0.20</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">error =</span> <span class="st">&quot;relative&quot;</span>, <span class="at">se =</span> <span class="dv">1</span>, <span class="at">sp =</span> <span class="dv">1</span>, <span class="at">nfractional =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>n.crude</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 246</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A total of 246 individuals (SSUs) need to be enrolled into the study. Calculate the design effect:</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.02</span>; b <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> rho <span class="sc">*</span> (b <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span>; D</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.38</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># The design effect is 1.38 so our crude sample size estimate needs to be increased by a factor of 1.38.</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>n.adj <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(n.crude <span class="sc">*</span> D)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>n.adj</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 340</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># After accounting for lack of independence in the data a total of 340 individuals (SSUs) need to be enrolled into the study. </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># How many villages (PSUs) are required?</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(n.adj <span class="sc">/</span> b)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 17</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># A total of 17 villages need to be sampled to meet the requirements of the study.</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Do all of the above using epi.ssclus2estb:</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.ssclus2estb</span>(<span class="at">b =</span> <span class="dv">20</span>, <span class="at">Py =</span> <span class="fl">0.20</span>, <span class="at">epsilon =</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="fl">0.20</span>, <span class="at">error =</span> <span class="st">&quot;relative&quot;</span>, </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>   <span class="at">rho =</span> <span class="fl">0.02</span>, <span class="at">nfractional =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: The calculated number of primary sampling units (n.psu) is 17. At</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; least 25 primary sampling units are recommended for two-stage cluster sampling</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; designs.</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.psu</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 17</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.ssu</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 340</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $DEF</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.38</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $rho</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.02</span></span></code></pre></div>
<p>A total of 17 villages need to be sampled to meet the requirements of
this study. From each sampled village 20 individuals are sampled which
means that at total of 17 <span class="math inline">\(\times\)</span> 20
= 340 individuals are required. Function <code>epi.ssclus2estb</code>
returns a warning message, reminding you that at least 25 primary
sampling units are recommended for two-stage cluster sampling
designs.</p>
</div>
<div id="two-stage-cluster-sampling-continued" class="section level3">
<h3>Two-stage cluster sampling (continued)</h3>
<p>Continuing the brucellosis prevalence example (above) being
seropositive to brucellosis is likely to cluster within herds. <span class="citation">Otte and Gumm (<a href="#ref-otte_gumm:1997" role="doc-biblioref">1997</a>)</span> cite the intracluster correlation
coefficient for Brucella abortus in cattle to be in the order of 0.09.
Adjust your sample size of 545 cows to account for lack of independence
in the data, i.e., clustering at the herd level. Assume that
<code>b</code> = 10 animals will be sampled per herd:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>n.crude <span class="ot">&lt;-</span> <span class="fu">epi.sssimpleestb</span>(<span class="at">N =</span> <span class="cn">NA</span>, <span class="at">Py =</span> <span class="fl">0.15</span>, <span class="at">epsilon =</span> <span class="fl">0.20</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">error =</span> <span class="st">&quot;relative&quot;</span>, <span class="at">se =</span> <span class="dv">1</span>, <span class="at">sp =</span> <span class="dv">1</span>, <span class="at">nfractional =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>n.crude</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 545</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.09</span>; b <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> rho <span class="sc">*</span> (b <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span>; D</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.81</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>n.adj <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(n.crude <span class="sc">*</span> D)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>n.adj</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 987</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Similar to the example above, we can do all of these calculations using epi.ssclus2estb:</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.ssclus2estb</span>(<span class="at">b =</span> <span class="dv">10</span>, <span class="at">Py =</span> <span class="fl">0.15</span>, <span class="at">epsilon =</span> <span class="fl">0.20</span>, <span class="at">error =</span> <span class="st">&quot;relative&quot;</span>, </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>   <span class="at">rho =</span> <span class="fl">0.09</span>, <span class="at">nfractional =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.psu</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 99</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.ssu</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 986</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $DEF</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.81</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $rho</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.09</span></span></code></pre></div>
<p>After accounting for clustering at the herd level we estimate that a
total of (545 <span class="math inline">\(\times\)</span> 1.81) = 986
cattle need to be sampled to meet the requirements of the study. If 10
cows are sampled per herd this means that a total of (986 <span class="math inline">\(\div\)</span> 10) = 99 herds are required.</p>
</div>
<div id="references" class="section level3 unnumbered">
<h3 class="unnumbered">References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bennett_et_al:1991" class="csl-entry">
Bennett, S, T Woods, W Liyanage, and D Smith. 1991. <span>“A Simplified
General Method for Cluster-Sample Surveys of Health in Developing
Countries.”</span> <em>World Health Statistics Quarterly</em> 44:
98–106.
</div>
<div id="ref-otte_gumm:1997" class="csl-entry">
Otte, JM, and ID Gumm. 1997. <span>“Intra-Cluster Correlation
Coefficients of 20 Infections Calculated from the Results of
Cluster-Sample Surveys.”</span> <em>Preventive Veterinary Medicine</em>
31: 147–50.
</div>
<div id="ref-stevenson:2021" class="csl-entry">
Stevenson, MA. 2021. <span>“Sample Size Estimation in Veterinary
Epidemiological Research.”</span> Journal Article. <em>Frontiers in
Veterinary Science</em> 7: 539573.
</div>
</div>
</div>

<script type="text/javascript">
window.onload = function() {
  var i, fig = 1, caps = document.getElementsByClassName('caption');
  for (i = 0; i < caps.length; i++) {
    var cap = caps[i];
    if (cap.parentElement.className !== 'figure' || cap.nodeName !== 'P')
      continue;
    cap.innerHTML = '<span>Figure ' + fig + ':</span> ' + cap.innerHTML;
    fig++;
  }
  fig = 1;
  caps = document.getElementsByTagName('caption');
  for (i = 0; i < caps.length; i++) {
    var cap = caps[i];
    if (cap.parentElement.nodeName !== 'TABLE') continue;
    cap.innerHTML = '<span>Table ' + fig + ':</span> ' + cap.innerHTML;
    fig++;
  }
}
</script>


<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
